<!DOCTYPE html>
<html lang="bn">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>ID Card Entry</title>
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
<style>
  body { background:#f8f9fa; }
  #preview { max-width: 150px; border:1px solid #ccc; padding:5px; display:none; margin-bottom:10px; border-radius:5px; }
  .loading { color:orange; font-weight:bold; }
  @media (max-width:576px){
    #preview { max-width:100%; }
    .container { padding:0 10px; }
    .btn { font-size:1rem; }
  }
</style>
</head>
<body>

<div class="container mt-4">
  <div class="card shadow-sm p-3">
    <h4 class="text-center mb-3">ID Card Registration</h4>

    <input type="file" id="photo" class="form-control mb-2" onchange="previewImage()">
    <div class="text-center"><img id="preview" class="mb-3"></div>

    <input type="text" id="name" class="form-control mb-2" placeholder="নাম">
    <input type="text" id="designation" class="form-control mb-2" placeholder="পদবী">
    
    <select id="branch" class="form-control mb-2">
      <option value="">শাখা নির্বাচন করুন</option>
      <option>প্রধান শাখা</option>
      <option>জিয়াপার্ক শাখা</option>
      <option>কয়েরদাঁড়া শাখা</option>
    </select>

    <input type="text" id="village" class="form-control mb-2" placeholder="গ্রাম">
    <input type="text" id="post" class="form-control mb-2" placeholder="পোষ্ট">
    <input type="text" id="thana" class="form-control mb-2" placeholder="থানা">
    <input type="text" id="district" class="form-control mb-2" placeholder="জেলা">
    <input type="text" id="birthYear" class="form-control mb-2" placeholder="জন্ম তারিখ **/**/****">
    <input type="text" id="nid" class="form-control mb-2" placeholder="জন্মনিবন্ধন / ভোটার আইডি">
    <input type="text" id="blood" class="form-control mb-2" placeholder="রক্তের গ্রুপ">
    <input type="text" id="mobile" class="form-control mb-2" placeholder="মোবাইল নং">

    <button id="submitBtn" class="btn btn-primary w-100 mt-2" onclick="submitData()">Submit</button>
    <p class="text-center mt-2" id="msg"></p>
  </div>
</div>

<script>
const API = "https://script.google.com/macros/s/AKfycbyK53uI0OPi4E2RnDAsTUBmLTLAYBCLmaH0AZA6JPmL1_7tkLCBOf16M63Q2zL5GTaFSw/exec"; // এখানে Web App URL বসান

function previewImage(){
  const file = document.getElementById("photo").files[0];
  const preview = document.getElementById("preview");
  if(file){
    const reader = new FileReader();
    reader.onload = function(e){
      preview.src = e.target.result;
      preview.style.display = "block";
    }
    reader.readAsDataURL(file);
  }
}

function toBase64(file){
  return new Promise((res, rej)=>{
    const reader = new FileReader();
    reader.onload = ()=>res(reader.result);
    reader.onerror = err=>rej(err);
    reader.readAsDataURL(file);
  });
}

async function submitData(){
  const btn = document.getElementById("submitBtn");
  const msg = document.getElementById("msg");
  btn.disabled = true;
  msg.innerText = "⏳ একটু অপেক্ষা করুন...";
  msg.className = "text-center loading";

  const img = document.getElementById("photo").files[0];
  if(!img){ alert("ছবি দিন"); btn.disabled=false; msg.innerText=""; return; }

  const form = new FormData();
  ["name","designation","branch","village","post","thana","district","birthYear","nid","blood","mobile"].forEach(id=>{
    form.append(id, document.getElementById(id).value);
  });
  form.append("action","submit");
  form.append("image", await toBase64(img));

  try{
    const res = await fetch(API, { method:"POST", body: form });
    const data = await res.json();
    if(data.status=="success"){
      msg.innerText = "✅ সম্পূর্ণ হয়েছে, অন্যজনের জন্য চেষ্টা করুন";
      document.querySelectorAll("input,select").forEach(e=>e.value="");
      document.getElementById("preview").style.display="none";
    } else {
      msg.innerText = "❌ কিছু সমস্যা হয়েছে";
    }
  } catch(err){
    msg.innerText = "❌ Error: "+err;
  }
  btn.disabled = false;
}
</script>

</body>
</html>



